<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Issue Reporting Form</title>
</head>
<body>
  <h2>Report an Issue</h2>
  <form id="issueForm">
    <label for="issueType">Issue Type:</label><br />
    <select id="issueType" name="issueType" required>
      <option value="">-- Select --</option>
      <option value="Issue">Issue</option>
      <option value="General Issue">General Issue</option>
    </select><br /><br />

    <label for="customId">Custom ID:</label><br />
    <input type="text" id="customId" name="customId" required /><br /><br />

    <label for="institutionName">Institution Name:</label><br />
    <input type="text" id="institutionName" name="institutionName" required /><br /><br />

    <label for="issueDescription">Issue Description:</label><br />
    <textarea id="issueDescription" name="issueDescription" required></textarea><br /><br />

    <label for="miscIssue">Misc Issue (if any):</label><br />
    <input type="text" id="miscIssue" name="miscIssue" /><br /><br />

    <label for="part">Part (if any):</label><br />
    <input type="text" id="part" name="part" /><br /><br />

    <button type="submit">Submit</button>
  </form>

  <p id="statusMsg"></p>

  <script>
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbz0-RExldDCdVK2cVCMKOSMkaxFByoKSneGcC_J3J1oBD6mHVAP-cNwnoc3mAXrV7x4/exec';

    document.getElementById('issueForm').addEventListener('submit', function (e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((value, key) => data[key] = value);

      fetch(webAppUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      })
        .then(response => response.text())
        .then(text => {
          document.getElementById('statusMsg').innerText = text;
          e.target.reset();
        })
        .catch(err => {
          document.getElementById('statusMsg').innerText = 'Error: ' + err.message;
        });
    });
  </script>
</body>
</html>
